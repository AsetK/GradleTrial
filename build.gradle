
apply plugin : 'java'

ext.systemProperties= System.properties // or ext.env = System.getProperty("env")
ext.projectProperties= project.properties // we can use both: System.properties or project.properties


dependencies {
    testCompile 'junit:junit:4.12'
}

repositories {
    mavenCentral()
}

compileJava{
    doFirst {
        String profile = projectProperties.env.toString()
        if(!profile.equals("dev")&& 
                !profile.equals("qa")&& 
                !profile.equals("prod")){
            throw new InvalidUserDataException("NO env VALUE PASSED!!!")
        }
    }
}

processResources{
    doFirst {
        String profile = projectProperties.env.toString()
        if(!profile.equals("dev")&&
                !profile.equals("qa")&&
                !profile.equals("prod")){
            throw new InvalidUserDataException("NO env VALUE PASSED!!!")
        }
    }
}

jar {
    manifest {
        attributes 'Main-Class': 'com.epam.helloworldgradle.runner.Runner'
    }
}

switch (projectProperties.env) {
    case "dev":     apply from: "${projectProperties.env}.gradle";   break
    case "qa":      apply from: "${projectProperties.env}.gradle";   break
    case "prod":    apply from: "${projectProperties.env}.gradle";   break
}









